INFO: 2025/05/07 18:58:27 logger.go:45: Инициализация ETL Runner
INFO: 2025/05/07 18:58:27 logger.go:45: Запуск планировщика ETL с интервалом 1h0m0s
INFO: 2025/05/07 18:58:27 logger.go:45: Запланированный запуск ETL процесса
INFO: 2025/05/07 18:58:27 logger.go:45: Запуск ETL процесса
INFO: 2025/05/07 18:58:27 logger.go:45: Начало фазы Extract (Извлечение данных)
DEBUG: 2025/05/07 18:58:27 logger.go:67: Начало извлечения данных о пользователях
DEBUG: 2025/05/07 18:58:27 logger.go:67: Извлечено 10 пользователей
DEBUG: 2025/05/07 18:58:27 logger.go:67: Начало извлечения данных о чатах
DEBUG: 2025/05/07 18:58:27 logger.go:67: Извлечено 12 чатов
DEBUG: 2025/05/07 18:58:27 logger.go:67: Начало извлечения данных о сообщениях (lastRunTime: 0001-01-01 00:00:00 +0000 UTC, lastMessageID: 0)
DEBUG: 2025/05/07 18:58:27 logger.go:67: Извлечено 644 сообщений
INFO: 2025/05/07 18:58:27 logger.go:45: Фаза Extract завершена. Длительность: 6.367ms
INFO: 2025/05/07 18:58:27 logger.go:45: Извлечено: 644 сообщений, 10 пользователей, 12 чатов
INFO: 2025/05/07 18:58:27 logger.go:45: Начало фазы Transform (Преобразование данных)
INFO: 2025/05/07 18:58:27 logger.go:45: Проверка измерения времени...
DEBUG: 2025/05/07 18:58:27 logger.go:67: Проверка измерения времени...
DEBUG: 2025/05/07 18:58:27 logger.go:67: Измерение времени содержит 365 записей
INFO: 2025/05/07 18:58:27 logger.go:45: Преобразование данных пользователей...
DEBUG: 2025/05/07 18:58:27 logger.go:67: Обработка измерения пользователей...
INFO: 2025/05/07 18:58:27 logger.go:45: Обработано измерение пользователей. Трансформировано записей: 10
INFO: 2025/05/07 18:58:27 logger.go:45: Преобразование данных сообщений...
DEBUG: 2025/05/07 18:58:27 logger.go:67: Обработка фактов сообщений...
INFO: 2025/05/07 18:58:27 logger.go:45: Обработано фактов сообщений: 644
INFO: 2025/05/07 18:58:27 logger.go:45: Преобразование данных чатов...
DEBUG: 2025/05/07 18:58:27 logger.go:67: Обработка фактов чатов...
INFO: 2025/05/07 18:58:27 logger.go:45: Обработано фактов чатов: 12
INFO: 2025/05/07 18:58:27 logger.go:45: Формирование ежедневных агрегатов активности...
DEBUG: 2025/05/07 18:58:27 logger.go:67: Обработка ежедневной активности...
ERROR: 2025/05/07 18:58:27 logger.go:54: Ошибка при получении последнего обработанного сообщения: Error 1146 (42S02): Table 'chat_analytics.etl_runs' doesn't exist. Будут обработаны все данные.
INFO: 2025/05/07 18:58:27 logger.go:45: Начало обработки данных начиная с ID сообщения: 0
INFO: 2025/05/07 18:58:27 logger.go:45: Получено сообщений: 644, данных о регистрациях: 9
INFO: 2025/05/07 18:58:27 logger.go:45: Обработка ежедневной активности завершена. Сформировано фактов: 38
INFO: 2025/05/07 18:58:27 logger.go:45: Фаза Transform завершена. Длительность: 60.9023ms
INFO: 2025/05/07 18:58:27 logger.go:45: Начало фазы Load (Загрузка данных)
INFO: 2025/05/07 18:58:27 logger.go:45: Загрузка измерения пользователей...
INFO: 2025/05/07 18:58:27 logger.go:45: Начало загрузки данных пользователей (всего: 10)
INFO: 2025/05/07 18:58:27 logger.go:45: Загрузка данных пользователей завершена. Загружено записей: 10. Длительность: 5.7915ms
INFO: 2025/05/07 18:58:27 logger.go:45: Загрузка фактов сообщений...
INFO: 2025/05/07 18:58:27 logger.go:45: Начало загрузки фактов сообщений (всего: 644)
DEBUG: 2025/05/07 18:58:27 logger.go:67: Загружено 100 из 644 сообщений...
DEBUG: 2025/05/07 18:58:28 logger.go:67: Загружено 200 из 644 сообщений...
DEBUG: 2025/05/07 18:58:28 logger.go:67: Загружено 300 из 644 сообщений...
DEBUG: 2025/05/07 18:58:28 logger.go:67: Загружено 400 из 644 сообщений...
DEBUG: 2025/05/07 18:58:28 logger.go:67: Загружено 500 из 644 сообщений...
DEBUG: 2025/05/07 18:58:28 logger.go:67: Загружено 600 из 644 сообщений...
INFO: 2025/05/07 18:58:28 logger.go:45: Загрузка фактов сообщений завершена. Загружено записей: 644. Длительность: 171.6369ms
INFO: 2025/05/07 18:58:28 logger.go:45: Загрузка фактов чатов...
INFO: 2025/05/07 18:58:28 logger.go:45: Начало загрузки фактов чатов (всего: 12)
INFO: 2025/05/07 18:58:28 logger.go:45: Загрузка фактов чатов завершена. Загружено записей: 12. Длительность: 6.8835ms
INFO: 2025/05/07 18:58:28 logger.go:45: Загрузка фактов ежедневной активности...
INFO: 2025/05/07 18:58:28 logger.go:45: Начало загрузки фактов ежедневной активности (всего: 38)
INFO: 2025/05/07 18:58:28 logger.go:45: Загрузка фактов ежедневной активности завершена. Загружено записей: 38. Длительность: 15.9762ms
INFO: 2025/05/07 18:58:28 logger.go:45: Фаза Load завершена. Длительность: 211.0908ms
INFO: 2025/05/07 18:58:28 logger.go:45: Запуск линейной регрессии для прогнозирования трендов активности
INFO: 2025/05/07 18:58:28 logger.go:45: Запуск процесса линейной регрессии для прогнозирования активности
INFO: 2025/05/07 18:58:28 logger.go:45: Получение данных о ежедневной активности за последние 30 дней
INFO: 2025/05/07 18:58:28 logger.go:45: Получено 33 точек данных для анализа
INFO: 2025/05/07 18:58:28 logger.go:45: Построение модели линейной регрессии (все значения округляются до тысячных)
INFO: 2025/05/07 18:58:28 logger.go:45: Результаты модели: коэффициент наклона (a)=0.655, сдвиг (b)=7.761, R=0.948, R²=0.899
INFO: 2025/05/07 18:58:28 logger.go:45: Генерация прогнозов на 14 дней вперед
INFO: 2025/05/07 18:58:28 logger.go:45: Сохранение 14 прогнозов в базу данных
INFO: 2025/05/07 18:58:28 logger.go:45: Процесс линейной регрессии успешно завершен
INFO: 2025/05/07 18:58:28 logger.go:45: Запуск ChatRank для определения влиятельности пользователей
INFO: 2025/05/07 18:58:28 logger.go:45: Запуск процесса ChatRank
INFO: 2025/05/07 18:58:28 logger.go:45: Извлечение данных для ChatRank
INFO: 2025/05/07 18:58:28 logger.go:45: Запрос данных для расчета ChatRank
INFO: 2025/05/07 18:58:28 logger.go:45: Получено 24 записей о сообщениях для 10 отправителей
INFO: 2025/05/07 18:58:28 logger.go:45: Вычисление весов коммуникационных связей
INFO: 2025/05/07 18:58:28 logger.go:45: Вычислено 20 весов коммуникационных связей
INFO: 2025/05/07 18:58:28 logger.go:45: Начинаем расчет ChatRank для 10 пользователей
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 1, максимальная дельта: 0.264949
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 2, максимальная дельта: 0.208728
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 3, максимальная дельта: 0.194899
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 4, максимальная дельта: 0.156736
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 5, максимальная дельта: 0.142178
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 6, максимальная дельта: 0.116647
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 7, максимальная дельта: 0.103459
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 8, максимальная дельта: 0.086036
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 9, максимальная дельта: 0.075202
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 10, максимальная дельта: 0.063098
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 11, максимальная дельта: 0.054628
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 12, максимальная дельта: 0.046101
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 13, максимальная дельта: 0.039661
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 14, максимальная дельта: 0.033592
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 15, максимальная дельта: 0.028779
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 16, максимальная дельта: 0.024430
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 17, максимальная дельта: 0.020871
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 18, максимальная дельта: 0.017741
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 19, максимальная дельта: 0.015129
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 20, максимальная дельта: 0.012869
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 21, максимальная дельта: 0.010961
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 22, максимальная дельта: 0.009327
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 23, максимальная дельта: 0.007938
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 24, максимальная дельта: 0.006756
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 25, максимальная дельта: 0.005746
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 26, максимальная дельта: 0.004891
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 27, максимальная дельта: 0.004159
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 28, максимальная дельта: 0.003539
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 29, максимальная дельта: 0.003009
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 30, максимальная дельта: 0.002561
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 31, максимальная дельта: 0.002176
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 32, максимальная дельта: 0.001852
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 33, максимальная дельта: 0.001574
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 34, максимальная дельта: 0.001339
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 35, максимальная дельта: 0.001138
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 36, максимальная дельта: 0.000968
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 37, максимальная дельта: 0.000823
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 38, максимальная дельта: 0.000700
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 39, максимальная дельта: 0.000595
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 40, максимальная дельта: 0.000506
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 41, максимальная дельта: 0.000430
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 42, максимальная дельта: 0.000366
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 43, максимальная дельта: 0.000311
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 44, максимальная дельта: 0.000264
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 45, максимальная дельта: 0.000225
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 46, максимальная дельта: 0.000191
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 47, максимальная дельта: 0.000162
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 48, максимальная дельта: 0.000138
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 49, максимальная дельта: 0.000117
DEBUG: 2025/05/07 18:58:28 logger.go:67: Итерация 50, максимальная дельта: 0.000100
INFO: 2025/05/07 18:58:28 logger.go:45: Сходимость достигнута на итерации 50, дельта: 0.000100
INFO: 2025/05/07 18:58:28 logger.go:45: Расчет ChatRank завершен за 50 итераций
INFO: 2025/05/07 18:58:28 logger.go:45: Сохранено 10 рангов пользователей
INFO: 2025/05/07 18:58:28 logger.go:45: Сохранено 20 весов коммуникационных связей
INFO: 2025/05/07 18:58:28 logger.go:45: ChatRank успешно выполнен. Результаты сохранены.
INFO: 2025/05/07 18:58:28 logger.go:45: Процесс ChatRank успешно завершен. Время выполнения: 48.356ms
INFO: 2025/05/07 18:58:28 logger.go:45: ETL процесс успешно завершен. Длительность: 355.2552ms
INFO: 2025/05/07 18:59:06 logger.go:45: Планировщик ETL остановлен
INFO: 2025/05/07 18:59:06 logger.go:45: Завершение работы ETL Runner
INFO: 2025/05/07 19:27:52 logger.go:45: Инициализация ETL Runner
INFO: 2025/05/07 19:27:52 logger.go:45: Запуск линейной регрессии с параметрами: дней=30, прогноз=14 дней, доверие=0.95, минR²=0.30
INFO: 2025/05/07 19:27:52 logger.go:45: Запуск процесса линейной регрессии для прогнозирования активности
INFO: 2025/05/07 19:27:52 logger.go:45: Получение данных о ежедневной активности за последние 30 дней
INFO: 2025/05/07 19:27:52 logger.go:45: Получено 33 точек данных для анализа
INFO: 2025/05/07 19:27:52 logger.go:45: Построение модели линейной регрессии (все значения округляются до тысячных)
INFO: 2025/05/07 19:27:52 logger.go:45: Результаты модели: коэффициент наклона (a)=0.655, сдвиг (b)=7.761, R=0.948, R²=0.899
INFO: 2025/05/07 19:27:52 logger.go:45: Генерация прогнозов на 14 дней вперед
INFO: 2025/05/07 19:27:52 logger.go:45: Сохранение 14 прогнозов в базу данных
INFO: 2025/05/07 19:27:52 logger.go:45: Процесс линейной регрессии успешно завершен
INFO: 2025/05/07 19:27:52 logger.go:45: Завершение работы ETL Runner
INFO: 2025/05/07 19:29:43 logger.go:45: Инициализация ETL Runner
INFO: 2025/05/07 19:29:43 logger.go:45: Запуск ChatRank с параметрами: damping=0.85, iterations=100, epsilon=0.000100, веса=[0.25, 0.25, 0.25, 0.25]
INFO: 2025/05/07 19:29:43 logger.go:45: Запуск процесса ChatRank с пользовательской конфигурацией
INFO: 2025/05/07 19:29:43 logger.go:45: Извлечение данных для ChatRank
INFO: 2025/05/07 19:29:43 logger.go:45: Запрос данных для расчета ChatRank
INFO: 2025/05/07 19:29:43 logger.go:45: Получено 24 записей о сообщениях для 10 отправителей
INFO: 2025/05/07 19:29:43 logger.go:45: Вычисление весов коммуникационных связей
INFO: 2025/05/07 19:29:43 logger.go:45: Вычислено 20 весов коммуникационных связей
INFO: 2025/05/07 19:29:43 logger.go:45: Начинаем расчет ChatRank для 10 пользователей
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 1, максимальная дельта: 0.264057
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 2, максимальная дельта: 0.208307
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 3, максимальная дельта: 0.194639
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 4, максимальная дельта: 0.156648
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 5, максимальная дельта: 0.142136
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 6, максимальная дельта: 0.116627
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 7, максимальная дельта: 0.103463
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 8, максимальная дельта: 0.086021
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 9, максимальная дельта: 0.075208
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 10, максимальная дельта: 0.063079
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 11, максимальная дельта: 0.054629
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 12, максимальная дельта: 0.046080
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 13, максимальная дельта: 0.039657
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 14, максимальная дельта: 0.033572
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 15, максимальная дельта: 0.028773
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 16, максимальная дельта: 0.024413
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 17, максимальная дельта: 0.020865
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 18, максимальная дельта: 0.017727
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 19, максимальная дельта: 0.015122
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 20, максимальная дельта: 0.012858
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 21, максимальная дельта: 0.010955
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 22, максимальная дельта: 0.009319
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 23, максимальная дельта: 0.007933
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 24, максимальная дельта: 0.006749
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 25, максимальная дельта: 0.005743
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 26, максимальная дельта: 0.004886
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 27, максимальная дельта: 0.004156
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 28, максимальная дельта: 0.003536
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 29, максимальная дельта: 0.003006
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 30, максимальная дельта: 0.002558
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 31, максимальная дельта: 0.002174
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 32, максимальная дельта: 0.001850
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 33, максимальная дельта: 0.001572
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 34, максимальная дельта: 0.001338
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 35, максимальная дельта: 0.001137
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 36, максимальная дельта: 0.000967
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 37, максимальная дельта: 0.000822
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 38, максимальная дельта: 0.000699
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 39, максимальная дельта: 0.000594
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 40, максимальная дельта: 0.000505
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 41, максимальная дельта: 0.000429
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 42, максимальная дельта: 0.000365
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 43, максимальная дельта: 0.000310
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 44, максимальная дельта: 0.000264
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 45, максимальная дельта: 0.000224
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 46, максимальная дельта: 0.000191
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 47, максимальная дельта: 0.000162
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 48, максимальная дельта: 0.000138
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 49, максимальная дельта: 0.000117
DEBUG: 2025/05/07 19:29:43 logger.go:67: Итерация 50, максимальная дельта: 0.000100
INFO: 2025/05/07 19:29:43 logger.go:45: Сходимость достигнута на итерации 50, дельта: 0.000100
INFO: 2025/05/07 19:29:43 logger.go:45: Расчет ChatRank завершен за 50 итераций
INFO: 2025/05/07 19:29:43 logger.go:45: Сохранено 10 рангов пользователей
INFO: 2025/05/07 19:29:43 logger.go:45: Сохранено 20 весов коммуникационных связей
INFO: 2025/05/07 19:29:43 logger.go:45: ChatRank успешно выполнен. Результаты сохранены.
INFO: 2025/05/07 19:29:43 logger.go:45: Процесс ChatRank с пользовательской конфигурацией успешно завершен. Время выполнения: 35.6834ms
INFO: 2025/05/07 19:29:43 logger.go:45: Завершение работы ETL Runner
INFO: 2025/05/07 19:32:10 logger.go:45: Инициализация ETL Runner
INFO: 2025/05/07 19:32:10 logger.go:45: Запуск ETL процесса
INFO: 2025/05/07 19:32:10 logger.go:45: Начало фазы Extract (Извлечение данных)
DEBUG: 2025/05/07 19:32:10 logger.go:67: Начало извлечения данных о пользователях
DEBUG: 2025/05/07 19:32:10 logger.go:67: Извлечено 10 пользователей
DEBUG: 2025/05/07 19:32:10 logger.go:67: Начало извлечения данных о чатах
DEBUG: 2025/05/07 19:32:10 logger.go:67: Извлечено 14 чатов
DEBUG: 2025/05/07 19:32:10 logger.go:67: Начало извлечения данных о сообщениях (lastRunTime: 0001-01-01 00:00:00 +0000 UTC, lastMessageID: 0)
DEBUG: 2025/05/07 19:32:10 logger.go:67: Извлечено 744 сообщений
INFO: 2025/05/07 19:32:10 logger.go:45: Фаза Extract завершена. Длительность: 5.6445ms
INFO: 2025/05/07 19:32:10 logger.go:45: Извлечено: 744 сообщений, 10 пользователей, 14 чатов
INFO: 2025/05/07 19:32:10 logger.go:45: Начало фазы Transform (Преобразование данных)
INFO: 2025/05/07 19:32:10 logger.go:45: Проверка измерения времени...
DEBUG: 2025/05/07 19:32:10 logger.go:67: Проверка измерения времени...
DEBUG: 2025/05/07 19:32:10 logger.go:67: Измерение времени содержит 365 записей
INFO: 2025/05/07 19:32:10 logger.go:45: Преобразование данных пользователей...
DEBUG: 2025/05/07 19:32:10 logger.go:67: Обработка измерения пользователей...
INFO: 2025/05/07 19:32:10 logger.go:45: Обработано измерение пользователей. Трансформировано записей: 10
INFO: 2025/05/07 19:32:10 logger.go:45: Преобразование данных сообщений...
DEBUG: 2025/05/07 19:32:10 logger.go:67: Обработка фактов сообщений...
INFO: 2025/05/07 19:32:10 logger.go:45: Обработано фактов сообщений: 744
INFO: 2025/05/07 19:32:10 logger.go:45: Преобразование данных чатов...
DEBUG: 2025/05/07 19:32:10 logger.go:67: Обработка фактов чатов...
INFO: 2025/05/07 19:32:10 logger.go:45: Обработано фактов чатов: 14
INFO: 2025/05/07 19:32:10 logger.go:45: Формирование ежедневных агрегатов активности...
DEBUG: 2025/05/07 19:32:10 logger.go:67: Обработка ежедневной активности...
ERROR: 2025/05/07 19:32:10 logger.go:54: Ошибка при получении последнего обработанного сообщения: Error 1146 (42S02): Table 'chat_analytics.etl_runs' doesn't exist. Будут обработаны все данные.
INFO: 2025/05/07 19:32:10 logger.go:45: Начало обработки данных начиная с ID сообщения: 0
INFO: 2025/05/07 19:32:10 logger.go:45: Получено сообщений: 744, данных о регистрациях: 9
INFO: 2025/05/07 19:32:10 logger.go:45: Обработка ежедневной активности завершена. Сформировано фактов: 38
INFO: 2025/05/07 19:32:10 logger.go:45: Фаза Transform завершена. Длительность: 37.9568ms
INFO: 2025/05/07 19:32:10 logger.go:45: Начало фазы Load (Загрузка данных)
INFO: 2025/05/07 19:32:10 logger.go:45: Загрузка измерения пользователей...
INFO: 2025/05/07 19:32:10 logger.go:45: Начало загрузки данных пользователей (всего: 10)
INFO: 2025/05/07 19:32:10 logger.go:45: Загрузка данных пользователей завершена. Загружено записей: 10. Длительность: 3.9621ms
INFO: 2025/05/07 19:32:10 logger.go:45: Загрузка фактов сообщений...
INFO: 2025/05/07 19:32:10 logger.go:45: Начало загрузки фактов сообщений (всего: 744)
DEBUG: 2025/05/07 19:32:10 logger.go:67: Загружено 100 из 744 сообщений...
DEBUG: 2025/05/07 19:32:11 logger.go:67: Загружено 200 из 744 сообщений...
DEBUG: 2025/05/07 19:32:11 logger.go:67: Загружено 300 из 744 сообщений...
DEBUG: 2025/05/07 19:32:11 logger.go:67: Загружено 400 из 744 сообщений...
DEBUG: 2025/05/07 19:32:11 logger.go:67: Загружено 500 из 744 сообщений...
DEBUG: 2025/05/07 19:32:11 logger.go:67: Загружено 600 из 744 сообщений...
DEBUG: 2025/05/07 19:32:11 logger.go:67: Загружено 700 из 744 сообщений...
INFO: 2025/05/07 19:32:11 logger.go:45: Загрузка фактов сообщений завершена. Загружено записей: 744. Длительность: 126.1106ms
INFO: 2025/05/07 19:32:11 logger.go:45: Загрузка фактов чатов...
INFO: 2025/05/07 19:32:11 logger.go:45: Начало загрузки фактов чатов (всего: 14)
INFO: 2025/05/07 19:32:11 logger.go:45: Загрузка фактов чатов завершена. Загружено записей: 14. Длительность: 6.2473ms
INFO: 2025/05/07 19:32:11 logger.go:45: Загрузка фактов ежедневной активности...
INFO: 2025/05/07 19:32:11 logger.go:45: Начало загрузки фактов ежедневной активности (всего: 38)
INFO: 2025/05/07 19:32:11 logger.go:45: Загрузка фактов ежедневной активности завершена. Загружено записей: 38. Длительность: 9.4015ms
INFO: 2025/05/07 19:32:11 logger.go:45: Фаза Load завершена. Длительность: 151.0607ms
INFO: 2025/05/07 19:32:11 logger.go:45: Запуск линейной регрессии для прогнозирования трендов активности
INFO: 2025/05/07 19:32:11 logger.go:45: Запуск процесса линейной регрессии для прогнозирования активности
INFO: 2025/05/07 19:32:11 logger.go:45: Получение данных о ежедневной активности за последние 30 дней
INFO: 2025/05/07 19:32:11 logger.go:45: Получено 33 точек данных для анализа
INFO: 2025/05/07 19:32:11 logger.go:45: Построение модели линейной регрессии (все значения округляются до тысячных)
INFO: 2025/05/07 19:32:11 logger.go:45: Результаты модели: коэффициент наклона (a)=0.783, сдвиг (b)=8.435, R=0.833, R²=0.694
INFO: 2025/05/07 19:32:11 logger.go:45: Генерация прогнозов на 14 дней вперед
INFO: 2025/05/07 19:32:11 logger.go:45: Сохранение 14 прогнозов в базу данных
INFO: 2025/05/07 19:32:11 logger.go:45: Процесс линейной регрессии успешно завершен
INFO: 2025/05/07 19:32:11 logger.go:45: Запуск ChatRank для определения влиятельности пользователей
INFO: 2025/05/07 19:32:11 logger.go:45: Запуск процесса ChatRank
INFO: 2025/05/07 19:32:11 logger.go:45: Извлечение данных для ChatRank
INFO: 2025/05/07 19:32:11 logger.go:45: Запрос данных для расчета ChatRank
INFO: 2025/05/07 19:32:11 logger.go:45: Получено 28 записей о сообщениях для 10 отправителей
INFO: 2025/05/07 19:32:11 logger.go:45: Вычисление весов коммуникационных связей
INFO: 2025/05/07 19:32:11 logger.go:45: Вычислено 24 весов коммуникационных связей
INFO: 2025/05/07 19:32:11 logger.go:45: Начинаем расчет ChatRank для 10 пользователей
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 1, максимальная дельта: 0.217317
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 2, максимальная дельта: 0.180178
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 3, максимальная дельта: 0.157333
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 4, максимальная дельта: 0.135029
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 5, максимальная дельта: 0.116960
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 6, максимальная дельта: 0.100474
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 7, максимальная дельта: 0.086259
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 8, максимальная дельта: 0.074030
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 9, максимальная дельта: 0.063266
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 10, максимальная дельта: 0.054225
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 11, максимальная дельта: 0.046231
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 12, максимальная дельта: 0.039568
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 13, максимальная дельта: 0.033691
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 14, максимальная дельта: 0.028797
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 15, максимальная дельта: 0.024502
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 16, максимальная дельта: 0.020920
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 17, максимальная дельта: 0.017792
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 18, максимальная дельта: 0.015176
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 19, максимальная дельта: 0.012904
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 20, максимальная дельта: 0.010999
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 21, максимальная дельта: 0.009350
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 22, максимальная дельта: 0.007965
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 23, максимальная дельта: 0.006771
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 24, максимальная дельта: 0.005765
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 25, максимальная дельта: 0.004900
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 26, максимальная дельта: 0.004171
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 27, максимальная дельта: 0.003545
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 28, максимальная дельта: 0.003016
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 29, максимальная дельта: 0.002564
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 30, максимальная дельта: 0.002181
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 31, максимальная дельта: 0.001854
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 32, максимальная дельта: 0.001577
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 33, максимальная дельта: 0.001340
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 34, максимальная дельта: 0.001140
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 35, максимальная дельта: 0.000969
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 36, максимальная дельта: 0.000824
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 37, максимальная дельта: 0.000700
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 38, максимальная дельта: 0.000595
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 39, максимальная дельта: 0.000506
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 40, максимальная дельта: 0.000430
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 41, максимальная дельта: 0.000366
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 42, максимальная дельта: 0.000311
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 43, максимальная дельта: 0.000264
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 44, максимальная дельта: 0.000225
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 45, максимальная дельта: 0.000191
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 46, максимальная дельта: 0.000162
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 47, максимальная дельта: 0.000138
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 48, максимальная дельта: 0.000117
DEBUG: 2025/05/07 19:32:11 logger.go:67: Итерация 49, максимальная дельта: 0.000100
INFO: 2025/05/07 19:32:11 logger.go:45: Сходимость достигнута на итерации 49, дельта: 0.000100
INFO: 2025/05/07 19:32:11 logger.go:45: Расчет ChatRank завершен за 49 итераций
INFO: 2025/05/07 19:32:11 logger.go:45: Сохранено 10 рангов пользователей
INFO: 2025/05/07 19:32:11 logger.go:45: Сохранено 24 весов коммуникационных связей
INFO: 2025/05/07 19:32:11 logger.go:45: ChatRank успешно выполнен. Результаты сохранены.
INFO: 2025/05/07 19:32:11 logger.go:45: Процесс ChatRank успешно завершен. Время выполнения: 34.0762ms
INFO: 2025/05/07 19:32:11 logger.go:45: ETL процесс успешно завершен. Длительность: 245.7499ms
INFO: 2025/05/07 19:32:11 logger.go:45: Завершение работы ETL Runner
